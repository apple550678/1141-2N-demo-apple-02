### w12

```
context

'use client'

import { useState, createContext, useContext } from 'react'
import { data } from '../../_assets/_data/data'

// 1. 建立一個 Context (廣播頻道)
const PeopleContext = createContext()

// 2. 建立 Provider (資料供應商元件)
// 這原本是阿公元件做的事，現在全部搬到這裡來做
export const PeopleContextProvider_02 = ({ children }) => {
  const [people, setPeople] = useState(data) // 狀態在這裡

  const removePerson = (id) => { // 刪除邏輯也在這裡
    setPeople((people) => {
      return people.filter((person) => person.id !== id)
    })
  }

  // 3. 打包資料：把 people 和 removePerson 包在 value 裡面
  // 只要被這個元件包住的子元件，都可以拿到這些 value
  return (
    <PeopleContext.Provider value={{ people, removePerson }}>
      {children}
    </PeopleContext.Provider>
  )
}

// 4. 自定義 Hook (專用接收器)
// 這是一個方便的小工具，讓元件不用寫 useContext(PeopleContext) 這麼長
// 直接呼叫 usePeopleContext_02() 就可以連上線
export const usePeopleContext_02 = () => {
  return useContext(PeopleContext)
}
```

```
page

'use client'

import Wrapper from '../../_assets/_wrapper/Tutorials_xx'
// 匯入剛剛寫好的 Provider 和 Hook
import { usePeopleContext_02, PeopleContextProvider_02 } from './_context'

// --- [第一層：阿公元件] ---
const PropDrilling_02 = () => {
  return (
    // 1. [開啟廣播] 用 Provider 把所有內容包起來
    // 這樣裡面的元件才有權限去抓資料
    <PeopleContextProvider_02>
      <Wrapper>
        <div className='container'>
          <h3>Context API Demo</h3>
          {/* 2. [不用傳遞]
             你看！這裡的 List 標籤裡面空空如也。
             阿公不需要再把資料塞給爸爸了。
          */}
          <List />
        </div>
      </Wrapper>
    </PeopleContextProvider_02>
  )
}

// --- [第二層：爸爸元件] ---
const List = () => {
  // 3. [直接抓取]
  // 爸爸自己用 Hook 連上雲端，抓取「名單 (people)」
  // 爸爸完全不知道有「刪除 (removePerson)」這件事，因為他不需要用，所以也不用拿
  const { people } = usePeopleContext_02()

  return (
    <>
      {people.map((person) => {
        // 4. [不用傳遞]
        // 爸爸生出兒子時，也不用把刪除功能傳給兒子
        return <SinglePerson key={person.id} {...person} />
      })}
    </>
  )
}

// --- [第三層：孫子元件] ---
const SinglePerson = ({ id, name }) => {
  // 5. [直接抓取]
  // 孫子自己用 Hook 連上雲端，抓取「刪除功能 (removePerson)」
  // 這是直接「越級」拿資料，不用經過爸爸
  const { removePerson } = usePeopleContext_02()

  return (
    <div className='item'>
      <h4>{name}</h4>
      <button className='btn' onClick={() => removePerson(id)}>
        remove
      </button>
    </div>
  )
}

export default PropDrilling_02
```
